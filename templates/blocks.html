{{ block "session" . }}
<main id="session" class="grow flex flex-col space-y-8" hx-ext="ws" ws-connect="/ws/{{ .SessionId }}/{{ .MyUser.Name }}">
  <div class="flex p-4">
    <h1 class="grow text-4xl">{{ .SessionName }}</h1>
    <button class="border rounded border-white px-2 py-1 text-lg hover:scale-105 transition duration-200" id="restart-session" ws-send>Restart</button>
  </div>
  {{ template "users" . }}
  <div class="relative">
    <div class="fixed bottom-0 left-0 h-1/3 flex justify-center w-full bg-black">
      <div class="max-w-full">
        <fieldset class="flex flex-wrap items-center justify-center">
          {{ range .Scale }}
          <input
            class="peer/{{ . }} hidden"
            ws-send
            type="radio"
            id="{{ . }}"
            name="vote"
            value="{{ . }}"
          />
          <label
            class="hover:cursor-pointer transition duration-200 hover:scale-105 peer-checked/{{ . }}:bg-sky-800 text-xl rounded border border-white p-2 my-2 mx-2 w-16 text-center"
            for="{{ . }}"
            >
            {{ . }}
          </label>
          {{ end }}
          <input
            class="peer/? hidden"
            ws-send
            type="radio"
            id="?"
            name="vote"
            value="?"
          />
          <label
            class="hover:cursor-pointer transition duration-200 hover:scale-105 peer-checked/?:bg-sky-800 text-xl rounded border border-white p-2 my-2 mx-2 w-16 text-center"
            for="?"
            >
            ?
          </label>
        </fieldset>
      </div>
    </div>
  </div>
</main>
{{ end }}

{{ block "users" . }}
<div class="w-full flex" id="users" >
  <div class="w-1/2">
    <table class="border-separate border-spacing-4">
      <tbody>
        {{ template "my-user" . }}
        {{ template "other-users" . }}
      </tbody>
    </table>
  </div>
  <div id="result" class="w-1/2">
    {{ if .Recommendation }}
    <table class="border-separate border-spacing-4">
      <tbody>
        <tr>
          <td class="text-2xl font-bold">Average</td>
          <td class="text-2xl">{{ .Average }}</td>
        </tr>
        <tr>
          <td class="text-2xl font-bold">Median</td>
          <td class="text-2xl">{{ .Median }}</td>
        </tr>
        <tr>
          <td class="text-2xl font-bold">Recommendation</td>
          <td class="text-2xl">{{ .Recommendation }}</td>
        </tr>
      </tbody>
    </table>
    {{ end }}
  </div>
</div>
{{ end }}

{{ block "my-user" . }}
      <tr id="user-{{ .MyUser.Name }}">
        <td class="text-xl font-bold">
          {{ .MyUser.Name }} (Me)
        </td>
        <td class="text-lg rounded border p-1 border-sky-300 text-sky-300 text-center">
          {{ if eq .MyUser.Vote -1 }}
          Voting...
          {{ else }}
          {{ .MyUser.Vote }}
          {{ end }}
        </td>
      </tr>
{{ end }}

{{ block "other-users" . }}
  {{ if .AllVoted }}
    {{ range .OtherUsers }}
      <tr id="user-{{ .Name }}">
        <td class="text-xl">
          {{ .Name }}
        </td>
        <td class="text-lg rounded border p-1 border-sky-300 text-sky-300 text-center">
          {{ .Vote }}
        </td>
      </tr>
    {{ end }}
  {{ else }}
    {{ range .OtherUsers }}
      <tr id="user-{{ .Name }}">
        <td class="text-xl">
          {{ .Name }}
        </td>
        <td class="text-lg rounded border p-1 border-sky-300 text-sky-300 text-center">
          {{ if eq .Vote -1 }}
          Voting...
          {{ else }}
          Voted
          {{ end }}
        </td>
      </tr>
    {{ end }}
  {{ end }}
{{ end }}
